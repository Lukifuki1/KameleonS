# docker_template.yaml

version: '3.9'

services:
  model_runner:
    image: registry.local/kameleon-model:latest
    container_name: kameleon_model
    restart: unless-stopped
    environment:
      - MODEL_PATH=/models/qwen3-coder-30b
      - MODEL_TYPE=gguf
      - EMBEDDING=false
    volumes:
      - /media/4tb/Kameleon/cell/models/base:/models:ro
      - /media/4tb/Kameleon/cell/cell_logs:/cell_logs
    entrypoint: ["/bin/bash", "-c"]
    command:
      - >
        python3 /app/infer.py
        --model-path ${MODEL_PATH}
        --log-dir /logs
    networks:
      - kameleon_net
    security_opt:
      - no-new-privileges:true
    read_only: true
    tmpfs:
      - /tmp

networks:
  kameleon_net:
    driver: bridge

